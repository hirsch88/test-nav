import{__awaiter,__generator,__spreadArray}from"tslib";import{r as registerInstance,c as createEvent,h,H as Host,g as getElement}from"./index-e015dbc8.js";import{m as debounceEvent}from"./helpers-08b28736.js";import{i as inheritAttributes}from"./attributes-56afda45.js";import{i as inputHandleFocus,e as inputHandleBlur,f as inputHandleChange,s as stopEventBubbling,h as inputHandleClick,a as inputHandleHostClick,b as inputListenOnClick,j as inputHandleReset,c as inputSetFocus,d as inputSetBlur,g as getInputTarget}from"./form-input-fd2d14ca.js";import{l as lodash_isnil}from"./index-82aff103.js";import{i as isCtrlOrCommandKey,A as ACTION_KEYS,N as NUMBER_KEYS}from"./keys.constant-a195c4b1.js";import{B as BEM}from"./bem-1b28532d.js";import{L as Logger}from"./log-01623e2c.js";import{d as defaultBalAriaForm}from"./form-479fd066.js";import"./browser-9199b5e2.js";import"./icons.constant-35253412.js";function formatClaim(t){if(!t){return""}var e="".concat(t).trim().toUpperCase();var n=[e.substring(0,2),e.substring(2,8),e.substring(8,10),e.substring(10,11)].filter((function(t){return t.length>0}));switch(n.length){case 1:return"".concat(t);case 2:return"".concat(n[0],"/").concat(n[1]);case 3:return"".concat(n[0],"/").concat(n[1],"/").concat(n[2]);default:return"".concat(n[0],"/").concat(n[1],"/").concat(n[2],".").concat(n[3])}}function formatPolicy(t){if(!t){return""}var e="".concat(t).trim();var n=[e.substring(0,9),e.substring(9,10)].filter((function(t){return t.length>0}));e=formatOffer(n[0]);return n[1]?"".concat(e,"-").concat(n[1]):e}function formatOffer(t){if(!t){return""}var e="".concat(t).trim();var n=[e.substring(0,2),e.substring(2,3),e.substring(3,6),e.substring(6,9)].filter((function(t){return t.length>0}));switch(n.length){case 1:return"".concat(e);case 2:return"".concat(n[0],"/").concat(n[1]);case 3:return"".concat(n[0],"/").concat(n[1],".").concat(n[2]);default:return"".concat(n[0],"/").concat(n[1],".").concat(n[2],".").concat(n[3])}}function formatBeEnterpriseNumber(t){if(!t){return""}var e="".concat(t).trim();var n=[e.substring(0,4),e.substring(4,7),e.substring(7,10)].filter((function(t){return t.length>0}));switch(n.length){case 1:return"".concat(e);case 2:return"".concat(n[0],".").concat(n[1]);default:return"".concat(n[0],".").concat(n[1],".").concat(n[2])}}function formatBeIBAN(t){if(!t){return""}var e="".concat(t).trim();var n=[e.substring(0,2),e.substring(2,6),e.substring(6,10),e.substring(10,14)].filter((function(t){return t.length>0}));switch(n.length){case 1:return"BE".concat(e);case 2:return"BE".concat(n[0]," ").concat(n[1]);case 3:return"BE".concat(n[0]," ").concat(n[1]," ").concat(n[2]);default:return"BE".concat(n[0]," ").concat(n[1]," ").concat(n[2]," ").concat(n[3])}}var MAX_LENGTH_CONTRACT_NUMBER=10;var MAX_LENGTH_OFFER_NUMBER=9;var MAX_LENGTH_CLAIM_NUMBER=11;var MAX_LENGTH_BE_ENTERPRISE_NUMBER=10;var MAX_LENGTH_BE_IBAN=14;var balInputCss=".bal-input{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:block;position:relative;width:100%;-ms-flex:1;flex:1;font-family:var(--bal-font-family-text);padding:0}";var __decorate=undefined&&undefined.__decorate||function(t,e,n,i){var a=arguments.length,r=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(t,e,n,i);else for(var u=t.length-1;u>=0;u--)if(s=t[u])r=(a<3?s(r):a>3?s(e,n,r):s(e,n))||r;return a>3&&r&&Object.defineProperty(e,n,r),r};var Input=function(){function t(t){var e=this;registerInstance(this,t);this.balInput=createEvent(this,"balInput",7);this.balBlur=createEvent(this,"balBlur",7);this.balKeyPress=createEvent(this,"balKeyPress",7);this.balFocus=createEvent(this,"balFocus",7);this.balChange=createEvent(this,"balChange",7);this.inputId="bal-input-".concat(InputIds++);this.inheritedAttributes={};this.inputValue=this.value;this.initialValue=this.value||"";this.getInputValue=function(){var t;var n=e.nativeInput;var i="";if(n){if(e.allowedKeyPress&&n&&!e.mask){var a=new RegExp("^"+e.allowedKeyPress+"$");var r=n.value.split("").filter((function(t){return a.test(t)})).join("");n.value=r;return r}if(n.value){if(e.mask){switch(e.mask){case"contract-number":{i=n.value.replace(/\D/g,"");if(i.length>MAX_LENGTH_CONTRACT_NUMBER){i=i.substring(0,MAX_LENGTH_CONTRACT_NUMBER)}return i}case"offer-number":{i=n.value.replace(/\D/g,"");if(i.length>MAX_LENGTH_OFFER_NUMBER){i=i.substring(0,MAX_LENGTH_OFFER_NUMBER)}return i}case"claim-number":{i=n.value.replace(/[^\dXx]/g,"");var s=[i.substring(0,MAX_LENGTH_CLAIM_NUMBER-1),i.substring(MAX_LENGTH_CLAIM_NUMBER-1,MAX_LENGTH_CLAIM_NUMBER),i.substring(MAX_LENGTH_CLAIM_NUMBER)].filter((function(t){return t.length>0}));switch(s.length){case 1:i="".concat(s[0].replace(/\D/g,""));break;case 2:i="".concat(s[0].replace(/\D/g,"")).concat(s[1]);break;default:i="".concat(s[0].replace(/\D/g,"")).concat(s[1]).concat((t=s[2])===null||t===void 0?void 0:t.replace(/\D/g,""))}if(i.length>MAX_LENGTH_CLAIM_NUMBER){i=i.substring(0,MAX_LENGTH_CLAIM_NUMBER)}return i}case"be-enterprise-number":{i=n.value.replace(/\D/g,"");if(i.length>MAX_LENGTH_BE_ENTERPRISE_NUMBER){i=i.substring(0,MAX_LENGTH_BE_ENTERPRISE_NUMBER)}return i}case"be-iban":{i=n.value.replace(/\D/g,"");if(i.length>MAX_LENGTH_BE_IBAN){i=i.substring(0,MAX_LENGTH_BE_IBAN)}return i}default:return n.value}}}else{e.inputValue=n.value}}return""};this.onInput=function(t){var n,i;var a=getInputTarget(t);var r=(n=t.target)===null||n===void 0?void 0:n.selectionStart;var s=(i=t.target)===null||i===void 0?void 0:i.selectionEnd;e.inputValue=e.getInputValue();if(a){if(a.value){switch(e.mask){case"contract-number":{a.value=formatPolicy(e.inputValue);if(r<e.inputValue.length){a.setSelectionRange(r,s)}break}case"offer-number":{a.value=formatOffer(e.inputValue);if(r<e.inputValue.length){a.setSelectionRange(r,s)}break}case"claim-number":{a.value=formatClaim(e.inputValue);if(r<e.inputValue.length){a.setSelectionRange(r,s)}break}case"be-enterprise-number":{a.value=formatBeEnterpriseNumber(e.inputValue);if(r<e.inputValue.length){a.setSelectionRange(r,s)}break}case"be-iban":{a.value=formatBeIBAN(e.inputValue);if(r<e.inputValue.length){a.setSelectionRange(r,s)}break}default:e.inputValue=a.value}}else{e.inputValue=a.value}}e.balInput.emit(e.inputValue)};this.onFocus=function(t){return inputHandleFocus(e,t)};this.onBlur=function(t){inputHandleBlur(e,t);var n=t.target;if(n){if(e.mask===undefined){n.value=e.getFormattedValue()}inputHandleChange(e)}};this.onKeydown=function(t){if(e.mask!==undefined&&!lodash_isnil(t)&&!isCtrlOrCommandKey(t)){var n=0;if(e.inputValue){n=e.inputValue.length}if(!(e.getMaskAllowedKeys().includes(t.key)||e.mask==="claim-number"&&(t.key==="X"||t.key==="x")&&n>=MAX_LENGTH_CLAIM_NUMBER-1)){return stopEventBubbling(t)}}if(e.allowedKeyPress&&!e.mask&&!lodash_isnil(t)&&!isCtrlOrCommandKey(t)){var i=new RegExp("^"+e.allowedKeyPress+"$");if(!i.test(t.key)&&!__spreadArray([],ACTION_KEYS,true).includes(t.key)){return stopEventBubbling(t)}}};this.onClick=function(t){return inputHandleClick(e,t)};this.handleClick=function(t){return inputHandleHostClick(e,t)};this.focused=false;this.ariaForm=defaultBalAriaForm;this.name=this.inputId;this.invalid=false;this.textAlign="left";this.type="text";this.accept=undefined;this.autocapitalize="off";this.autocomplete="off";this.autocorrect="off";this.autofocus=false;this.debounce=0;this.placeholder=undefined;this.max=undefined;this.maxLength=undefined;this.min=undefined;this.minLength=undefined;this.multiple=undefined;this.pattern=undefined;this.allowedKeyPress=undefined;this.required=false;this.spellcheck=false;this.disabled=false;this.readonly=false;this.clickable=false;this.suffix=undefined;this.hasIconRight=false;this.inputmode=undefined;this.value=undefined;this.mask=undefined}t.prototype.createLogger=function(t){this.log=t};t.prototype.debounceChanged=function(){this.balChange=debounceEvent(this.balChange,this.debounce)};t.prototype.listenOnClick=function(t){inputListenOnClick(this,t)};t.prototype.resetHandler=function(t){var e=t.target;if(e===null||e===void 0?void 0:e.contains(this.el)){inputHandleReset(this,this.initialValue,this.resetHandlerTimer)}};t.prototype.connectedCallback=function(){this.debounceChanged();this.initialValue=this.value||""};t.prototype.componentWillLoad=function(){this.inheritedAttributes=inheritAttributes(this.el,["aria-label","tabindex","title"])};t.prototype.componentDidLoad=function(){this.inputValue=this.value};t.prototype.setFocus=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){inputSetFocus(this);return[2]}))}))};t.prototype.setBlur=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){inputSetBlur(this);return[2]}))}))};t.prototype.getInputElement=function(){return Promise.resolve(this.nativeInput)};t.prototype.setAriaForm=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.ariaForm=Object.assign({},t);return[2]}))}))};t.prototype.getRawValue=function(){var t=(this.value||"").toString();return t};t.prototype.getFormattedValue=function(){var t=this.getRawValue();var e=this.suffix!==undefined&&t!==undefined&&t!==""?" "+this.suffix:"";return"".concat(t).concat(e)};t.prototype.getMaskAllowedKeys=function(){return __spreadArray(__spreadArray([],NUMBER_KEYS,true),ACTION_KEYS,true)};t.prototype.render=function(){var t=this;var e=this.focused?this.getRawValue():this.getFormattedValue();if(this.mask!==undefined){switch(this.mask){case"contract-number":e=formatPolicy(e);break;case"claim-number":e=formatClaim(e);break;case"offer-number":e=formatOffer(e);break;case"be-enterprise-number":e=formatBeEnterpriseNumber(e);break;case"be-iban":e=formatBeIBAN(e);break}}var n={};if(this.pattern){n={pattern:this.pattern}}var i=BEM.block("input");var a=this.ariaForm.controlId||this.inputId;return h(Host,{onClick:this.handleClick,"aria-disabled":this.disabled?"true":null,class:Object.assign({},i.class())},h("input",Object.assign({class:{input:true,"is-disabled":this.disabled||this.readonly,"is-danger":this.invalid,clickable:this.clickable,"bal-focusable":!this.disabled,"has-icon-right":this.hasIconRight,"has-text-centered":this.textAlign==="center","has-text-right":this.textAlign==="right"},"data-testid":"bal-input",ref:function(e){return t.nativeInput=e},id:a,"aria-labelledby":this.ariaForm.labelId,"aria-describedby":this.ariaForm.messageId,"aria-invalid":this.invalid===true?"true":"false","aria-disabled":this.disabled?"true":null,disabled:this.disabled,accept:this.accept,inputMode:this.inputmode,autoCapitalize:this.autocapitalize,autocomplete:this.autocomplete,autocorrect:this.autocorrect,autofocus:this.autofocus,min:this.min,max:this.max,minLength:this.minLength,maxLength:this.maxLength,multiple:this.multiple,name:this.name,placeholder:this.placeholder||"",readonly:this.readonly,required:this.required,spellcheck:this.spellcheck,type:this.type,value:e,onFocus:this.onFocus,onInput:function(e){return t.onInput(e)},onKeyDown:function(e){return t.onKeydown(e)},onBlur:this.onBlur,onClick:this.onClick,onKeyPress:function(e){return t.balKeyPress.emit(e)}},n,this.inheritedAttributes)))};Object.defineProperty(t.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{debounce:["debounceChanged"]}},enumerable:false,configurable:true});return t}();__decorate([Logger("bal-input")],Input.prototype,"createLogger",null);var InputIds=0;Input.style={css:balInputCss};export{Input as bal_input};