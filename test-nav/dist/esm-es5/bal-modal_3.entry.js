import{__awaiter,__generator}from"tslib";import{r as registerInstance,c as createEvent,w as writeTask,h,H as Host,g as getElement}from"./index-e015dbc8.js";import{p as prepareOverlay,d as dismiss,e as eventMethod}from"./overlays-dfd156f1.js";import{c as componentOnReady,f as deepReady,h as wait}from"./helpers-08b28736.js";import{B as BalScrollHandler}from"./scroll-e5864193.js";import"./browser-9199b5e2.js";import"./icons.constant-35253412.js";var attachComponent=function(e,t,n,a,i){return __awaiter(void 0,void 0,void 0,(function(){var r;return __generator(this,(function(o){switch(o.label){case 0:if(e){return[2,e.attachViewToDom(t,n,i,a)]}if(typeof n!=="string"&&!(n instanceof HTMLElement)){throw new Error("framework delegate is missing")}r=typeof n==="string"?t.ownerDocument&&t.ownerDocument.createElement(n):n;if(a){a.forEach((function(e){return r.classList.add(e)}))}if(i){Object.assign(r,i)}t.appendChild(r);return[4,new Promise((function(e){return componentOnReady(r,e)}))];case 1:o.sent();return[2,r]}}))}))};var detachComponent=function(e,t){if(t){if(e){var n=t.parentElement;return e.removeViewFromDom(n,t)}t.remove()}return Promise.resolve()};var getClassMap=function(e){var t={};getClassList(e).forEach((function(e){return t[e]=true}));return t};var getClassList=function(e){if(e!==undefined){var t=Array.isArray(e)?e:e.split(" ");return t.filter((function(e){return e!=null})).map((function(e){return e.trim()})).filter((function(e){return e!==""}))}return[]};var balModalCss=".bal-modal__background,.bal-modal{bottom:0;left:0;position:absolute;right:0;top:0}:root{--bal-modal-background:var(--bal-color-white);--bal-modal-backdrop-background:var(--bal-color-primary-6);--bal-modal-backdrop-opacity:.8;--bal-modal-radius:var(--bal-radius-large)}.bal-modal{-ms-flex-align:center;align-items:center;display:none;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:start;justify-content:flex-start;overflow:hidden;position:fixed;z-index:var(--bal-z-index-modal)}.bal-modal--is-active{display:-ms-flexbox;display:flex}.bal-modal__background{background:var(--bal-modal-backdrop-background);opacity:var(--bal-modal-backdrop-opacity)}.bal-modal__header__title{padding-right:2.5rem;line-height:2rem}.bal-modal__header__close{position:absolute !important;display:-ms-flexbox !important;display:flex !important;right:20px !important;top:24px !important;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;min-width:2rem;max-width:2rem;min-height:2rem;max-height:2rem}.bal-modal__container{position:fixed;top:0;bottom:0;left:0;right:0;overflow-x:none;overflow-y:auto;-ms-overflow-y:visible;padding:.5rem}@media screen and (min-width: 769px),print{.bal-modal__container{padding:0}}.bal-modal__content{overflow:none;position:relative;width:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;background:var(--bal-modal-background);border-radius:var(--bal-modal-radius);padding:1rem}@media screen and (min-width: 769px),print{.bal-modal__content{margin:3rem auto;width:var(--bal-modal-width, var(--bal-width, 640px))}}.bal-modal__content .bal-modal__header{padding-bottom:1rem}.bal-modal__content .bal-modal__header__close{right:1.2rem !important;top:.7rem !important}@media screen and (min-width: 769px),print{.bal-modal__content{padding:1.5rem}.bal-modal__content .bal-modal__header{padding-bottom:1.5rem}.bal-modal__content .bal-modal__header__close{right:1.6rem !important;top:1.2rem !important}}@media screen and (min-width: 1024px){.bal-modal__content{padding:2.5rem}.bal-modal__content .bal-modal__header{padding-bottom:2.5rem}.bal-modal__content .bal-modal__header__close{right:2.7rem !important;top:2.2rem !important}}@media screen and (min-width: 769px),print{.bal-modal__content--has-spacing-small{padding:1rem}.bal-modal__content--has-spacing-small .bal-modal__header{padding-bottom:1rem}.bal-modal__content--has-spacing-small .bal-modal__header__close{right:1.1rem !important;top:.7rem !important}}@media screen and (min-width: 1024px){.bal-modal__content--has-spacing-small{padding:1rem}.bal-modal__content--has-spacing-small .bal-modal__header{padding-bottom:1rem}.bal-modal__content--has-spacing-small .bal-modal__header__close{right:1.1rem !important;top:.7rem !important}}@media screen and (min-width: 769px),print{.bal-modal__content--has-spacing-medium{padding:1.5rem}.bal-modal__content--has-spacing-medium .bal-modal__header{padding-bottom:1.5rem}.bal-modal__content--has-spacing-medium .bal-modal__header__close{right:1.6rem !important;top:1.2rem !important}}@media screen and (min-width: 1024px){.bal-modal__content--has-spacing-medium{padding:1.5rem}.bal-modal__content--has-spacing-medium .bal-modal__header{padding-bottom:1.5rem}.bal-modal__content--has-spacing-medium .bal-modal__header__close{right:1.6rem !important;top:1.2rem !important}}.bal-modal__body>bal-button-group{padding-top:1rem}";var Modal=function(){function e(e){registerInstance(this,e);this.didPresent=createEvent(this,"balModalDidPresent",7);this.willPresent=createEvent(this,"balModalWillPresent",7);this.willDismiss=createEvent(this,"balModalWillDismiss",7);this.didDismiss=createEvent(this,"balModalDidDismiss",7);this.isClickedOutsideOnMouseDown=false;this.isClickedOutsideOnMouseUp=false;this.bodyScrollHandler=new BalScrollHandler;this.presented=false;this.overlayIndex=undefined;this.delegate=undefined;this.dataTestId=undefined;this.modalWidth=640;this.space="";this.hasBackdrop=true;this.isClosable=true;this.component=undefined;this.componentProps=undefined;this.cssClass=undefined;this.backdropDismiss=true}e.prototype.connectedCallback=function(){this.bodyScrollHandler.connect();prepareOverlay(this)};e.prototype.disconnectedCallback=function(){this.bodyScrollHandler.disconnect()};e.prototype.open=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){switch(t.label){case 0:return[4,deepReady(this.usersElement)];case 1:t.sent();this.setModalActiveOnBody();writeTask((function(){if(e.modalBackgroundElement){e.modalBackgroundElement.classList.add("fadeIn")}if(e.modalContentElement){e.modalContentElement.classList.add("fadeInDown")}}));if(this.presented){return[2]}this.willPresent.emit();this.presented=true;return[4,wait(150)];case 2:t.sent();writeTask((function(){if(e.modalBackgroundElement){e.modalBackgroundElement.classList.remove("fadeIn")}if(e.modalContentElement){e.modalContentElement.classList.remove("fadeInDown")}}));this.didPresent.emit();return[2]}}))}))};e.prototype.close=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.willDismiss.emit();this.unsetModalActiveOnBody();this.presented=false;this.didDismiss.emit();return[2]}))}))};e.prototype.present=function(){return __awaiter(this,void 0,void 0,(function(){var e,t,n;return __generator(this,(function(a){switch(a.label){case 0:this.setModalActiveOnBody();if(this.presented){return[2]}e=this.el.querySelector(".bal-modal__content");if(!e){throw new Error("container is undefined")}t=Object.assign(Object.assign({},this.componentProps),{modal:this.el});n=this;return[4,attachComponent(this.delegate,e,this.component,[],t)];case 1:n.usersElement=a.sent();return[4,this.open()];case 2:a.sent();return[2]}}))}))};e.prototype.dismiss=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n;var a=this;return __generator(this,(function(i){switch(i.label){case 0:this.unsetModalActiveOnBody();if(!(this.delegate===undefined))return[3,2];return[4,this.close()];case 1:i.sent();return[2,true];case 2:return[4,dismiss(this,e,t,(function(){return __awaiter(a,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){switch(t.label){case 0:writeTask((function(){if(e.modalBackgroundElement){e.modalBackgroundElement.classList.add("fadeOut")}if(e.modalContentElement){e.modalContentElement.classList.add("fadeOutUp")}}));return[4,wait(140)];case 1:t.sent();return[2]}}))}))}))];case 3:n=i.sent();if(!n)return[3,5];return[4,detachComponent(this.delegate,this.usersElement)];case 4:i.sent();i.label=5;case 5:return[2,n]}}))}))};e.prototype.onDidDismiss=function(){return eventMethod(this.el,"balModalDidDismiss")};e.prototype.onWillDismiss=function(){return eventMethod(this.el,"balModalWillDismiss")};e.prototype.onClickCloseButton=function(e){return __awaiter(this,void 0,void 0,(function(){var t,n;return __generator(this,(function(a){switch(a.label){case 0:if(!(this.isClosable&&this.presented&&e&&e.target))return[3,4];t=e.target;n=t.closest("bal-button");if(!(n&&n.hasAttribute("modal-close")))return[3,2];return[4,this.dismiss(undefined,"model-close")];case 1:a.sent();a.label=2;case 2:if(!(this.backdropDismiss&&this.isClickedOutsideOnMouseUp&&this.isClickedOutsideOnMouseDown))return[3,4];return[4,this.dismiss(undefined,"model-close")];case 3:a.sent();a.label=4;case 4:return[2]}}))}))};e.prototype.onMouseDown=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){this.isClickedOutsideOnMouseDown=this.isClickedOutside(e);return[2]}))}))};e.prototype.onMouseUp=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){this.isClickedOutsideOnMouseUp=this.isClickedOutside(e);return[2]}))}))};e.prototype.handleKeyUp=function(e){return __awaiter(this,void 0,void 0,(function(){var t,n,a;return __generator(this,(function(i){switch(i.label){case 0:t=Array.from(document.querySelectorAll("bal-modal")).filter((function(e){return e.hasAttribute("aria-presented")}));n=t.map((function(e){return e.overlayIndex})).map((function(e){return parseInt(e)})).filter((function(e){return!Number.isNaN(e)}));a=Math.max.apply(Math,n);if(!(this.overlayIndex===a))return[3,4];e.preventDefault();e.stopPropagation();if(!(this.presented&&this.isClosable))return[3,4];if(!(e.key==="Escape"||e.key==="Esc"))return[3,4];if(!this.delegate)return[3,2];return[4,this.dismiss(undefined,"model-escape")];case 1:i.sent();return[3,4];case 2:return[4,this.close()];case 3:i.sent();i.label=4;case 4:return[2]}}))}))};e.prototype.setModalActiveOnBody=function(){this.bodyScrollHandler.disable()};e.prototype.unsetModalActiveOnBody=function(){this.bodyScrollHandler.enable()};e.prototype.isClickedOutside=function(e){if(this.isClosable&&this.presented&&e&&e.target&&this.backdropDismiss){var t=e.target;return t.classList.contains("bal-modal__container")}return false};e.prototype.render=function(){var e;var t=this;return h(Host,{"aria-modal":"true","aria-presented":this.presented?"true":null,"data-testid":this.dataTestId,tabindex:"-1",class:Object.assign({"bal-modal":true,"bal-modal--is-closable":this.isClosable,"bal-modal--is-active":this.presented},getClassMap(this.cssClass)),style:{"--bal-width":"".concat(this.modalWidth,"px")}},h("div",{class:{"bal-modal__background":true,"is-hidden":!this.hasBackdrop},ref:function(e){return t.modalBackgroundElement=e}}),h("div",{class:{"bal-modal__container":true},ref:function(e){return t.modalContainerElement=e}},h("div",{class:(e={"bal-modal__content":true},e["bal-modal__content--has-spacing-".concat(this.space)]=true,e),ref:function(e){return t.modalContentElement=e}},h("slot",null))))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});return e}();Modal.style={css:balModalCss};var ModalBody=function(){function e(e){registerInstance(this,e)}e.prototype.render=function(){return h(Host,{class:"bal-modal__body"},h("slot",null))};return e}();var ModalHeader=function(){function e(e){var t=this;registerInstance(this,e);this.closeHandler=function(){if(t.parentModal){t.parentModal.dismiss(undefined,"model-close")}}}Object.defineProperty(e.prototype,"parentModal",{get:function(){return this.el.closest("bal-modal")},enumerable:false,configurable:true});e.prototype.render=function(){var e;return h(Host,{class:"bal-modal__header"},h("div",{class:"bal-modal__header__title"},h("bal-heading",{level:"h2",space:"none"},h("slot",null))),((e=this.parentModal)===null||e===void 0?void 0:e.isClosable)?h("bal-close",{class:"bal-modal__header__close data-test-modal-close",onClick:this.closeHandler}):"")};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});return e}();export{Modal as bal_modal,ModalBody as bal_modal_body,ModalHeader as bal_modal_header};