import{__awaiter,__generator}from"tslib";import{b as balBrowser}from"./browser-9199b5e2.js";import{j as addEventListener,k as removeEventListener}from"./helpers-08b28736.js";var lastId=0;var BACKDROP="backdrop";var prepareOverlay=function(e){if(balBrowser.hasDocument){connectListeners(document)}var r=lastId++;e.overlayIndex=r;if(!e.el.hasAttribute("id")){e.el.id="bal-overlay-".concat(r)}};var getOverlays=function(e,r){if(r===undefined){r="bal-modal,bal-snackbar,bal-toast"}return Array.from(e.querySelectorAll(r)).filter((function(e){return e.overlayIndex>0}))};var getOverlay=function(e,r,t){var n=getOverlays(e,r);return t===undefined?n[n.length-1]:n.find((function(e){return e.id===t}))};var connectListeners=function(e){if(lastId===0){lastId=1;e.addEventListener("keyup",(function(r){if(r.key==="Escape"){var t=getOverlay(e);if(t){t.dismiss(undefined,BACKDROP)}}}))}};var dismiss=function(e,r,t,n){return __awaiter(void 0,void 0,void 0,(function(){var a;return __generator(this,(function(s){switch(s.label){case 0:if(!e.presented){return[2,false]}s.label=1;case 1:s.trys.push([1,3,,4]);e.el.style.setProperty("pointer-events","none");e.willDismiss.emit({data:r,role:t});return[4,n()];case 2:s.sent();e.presented=false;e.didDismiss.emit({data:r,role:t});return[3,4];case 3:a=s.sent();e.presented=false;console.error(a);return[3,4];case 4:e.el.remove();return[2,true]}}))}))};var eventMethod=function(e,r){var t;var n=new Promise((function(e){return t=e}));onceEvent(e,r,(function(e){t(e.detail)}));return n};var onceEvent=function(e,r,t){var n=function(a){removeEventListener(e,r,n);t(a)};addEventListener(e,r,n)};export{getOverlay as a,dismiss as d,eventMethod as e,getOverlays as g,prepareOverlay as p};