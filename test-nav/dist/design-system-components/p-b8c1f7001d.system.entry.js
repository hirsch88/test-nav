var __awaiter=this&&this.__awaiter||function(e,i,t,n){function a(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,l){function r(e){try{o(n.next(e))}catch(e){l(e)}}function s(e){try{o(n["throw"](e))}catch(e){l(e)}}function o(e){e.done?t(e.value):a(e.value).then(r,s)}o((n=n.apply(e,i||[])).next())}))};var __generator=this&&this.__generator||function(e,i){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,r;return r={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(i){return o([e,i])}}function o(s){if(n)throw new TypeError("Generator is already executing.");while(r&&(r=0,s[0]&&(t=0)),t)try{if(n=1,a&&(l=s[0]&2?a["return"]:s[0]?a["throw"]||((l=a["return"])&&l.call(a),0):a.next)&&!(l=l.call(a,s[1])).done)return l;if(a=0,l)s=[s[0]&2,l.value];switch(s[0]){case 0:case 1:l=s;break;case 4:t.label++;return{value:s[1],done:false};case 5:t.label++;a=s[1];s=[0];continue;case 7:s=t.ops.pop();t.trys.pop();continue;default:if(!(l=t.trys,l=l.length>0&&l[l.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!l||s[1]>l[0]&&s[1]<l[3])){t.label=s[1];break}if(s[0]===6&&t.label<l[1]){t.label=l[1];l=s;break}if(l&&t.label<l[2]){t.label=l[2];t.ops.push(s);break}if(l[2])t.ops.pop();t.trys.pop();continue}s=i.call(e,t)}catch(e){s=[6,e];a=0}finally{n=l=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};var __spreadArray=this&&this.__spreadArray||function(e,i,t){if(t||arguments.length===2)for(var n=0,a=i.length,l;n<a;n++){if(l||!(n in i)){if(!l)l=Array.prototype.slice.call(i,0,n);l[n]=i[n]}}return e.concat(l||Array.prototype.slice.call(i))};System.register(["./p-4eb578e4.system.js","./p-2e048403.system.js","./p-4c4811f6.system.js","./p-a77fefb8.system.js","./p-3a73b8b5.system.js","./p-0ab50155.system.js","./p-8ff2ba35.system.js","./p-f15b4d27.system.js","./p-6913b916.system.js","./p-7dff37f8.system.js"],(function(e){"use strict";var i,t,n,a,l,r,s,o,u,d,f,c,h,p,b,v,m,g;return{setters:[function(e){i=e.h;t=e.r;n=e.c;a=e.H;l=e.g},function(e){r=e.g},function(e){s=e.s;o=e.a;u=e.i;d=e.e;f=e.c;c=e.d},function(e){h=e.L},function(e){p=e.c;b=e.g},function(e){v=e.B},function(e){m=e.F},function(e){g=e.d},function(){},function(){}],execute:function(){var y=p((function(e,i){Object.defineProperty(i,"__esModule",{value:true});var t={radix:1e3,unit:["b","kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"]};var n={radix:1024,unit:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"]};var a={radix:1024,unit:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"]};i.SPECS={si:t,iec:n,jedec:a}}));var _=p((function(e,i){Object.defineProperty(i,"__esModule",{value:true});function t(e,i,t){if(i===void 0){i=1}e=Math.abs(e);var n=y.SPECS[t]||y.SPECS["jedec"],a=n.radix,l=n.unit;var r=0;while(e>=a){e/=a;++r}return e.toFixed(i)+" "+l[r]}i.default=t}));var F=b(_);var I=v.block("file-upload").element("list");var E=function(e){var t=e.files,n=e.disabled,a=e.subTitle,l=e.onRemoveFile;return i("bal-card",{class:Object.assign({},I.class()),flat:true},i("bal-list",{disabled:n,border:true,size:"large"},t.map((function(e,t){return i("bal-list-item",{disabled:n},i("bal-list-item-icon",null,i("bal-icon",{name:"document"})),i("bal-list-item-content",null,i("bal-list-item-title",null,e.name),i("bal-list-item-subtitle",null,a?a(e):F(e.size))),i("bal-list-item-icon",{right:true,class:{"file-remove":true,"is-clickable":!n},onClick:function(e){return l(e,t)}},i("bal-icon",{name:"trash",color:n?"grey":"danger"})))}))))};var x=function(e){return Array.from(e?e:[])};var C=function(e){var i=new DataTransfer;if(e&&e.length>0){e.forEach((function(e){return i.items.add(e)}))}return i.files};var w=function(e,i,t){var n=[];var a=__spreadArray([],e,true);var l=[];var r=function(r){var s=i[r];if(s){var o=[];if(t.accept&&t.accept.split(" ").join("").split(",").indexOf(s.type)===-1){o.push(m.BAD_EXTENSION)}if(t.maxFileSize!==undefined&&s.size>t.maxFileSize){o.push(m.FILE_TOO_BIG)}var u=a.map((function(e){return e.size})).reduce((function(e,i){return e+i}),0);var d=u+s.size;if(t.maxBundleSize!==undefined&&d>t.maxBundleSize){o.push(m.FILE_SIZE_SUM_TOO_BIG)}var f=a.length+1;if(t.maxFiles!==undefined&&f>t.maxFiles){o.push(m.TOO_MANY_FILES)}var c=function(e,i){return e.size===i.size&&e.name===i.name&&e.type===i.type&&e.lastModified===i.lastModified};var h=e.filter((function(e){return c(e,s)}));if(h.length>0){o.push(m.DUPLICATED_FILE)}if(o.length>0){l.push({file:s,reasons:o})}else{a.push(s);n.push(s)}}};for(var s=0;s<i.length;s++){r(s)}return{validFiles:n,invalidFiles:l}};var j=".bal-file-upload{display:block;position:static;width:100%}.bal-file-upload .file-label{word-break:break-word;white-space:normal}.bal-file-upload .bal-heading{word-break:break-all}.bal-file-upload__card{margin-top:var(--bal-space-normal)}.bal-file-upload__list{padding:0 !important}";var D=undefined&&undefined.__decorate||function(e,i,t,n){var a=arguments.length,l=a<3?i:n===null?n=Object.getOwnPropertyDescriptor(i,t):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")l=Reflect.decorate(e,i,t,n);else for(var s=e.length-1;s>=0;s--)if(r=e[s])l=(a<3?r(l):a>3?r(i,t,l):r(i,t))||l;return a>3&&l&&Object.defineProperty(i,t,l),l};var k=e("bal_file_upload",function(){function e(e){var i=this;t(this,e);this.balChange=n(this,"balChange",7);this.balFilesAdded=n(this,"balFilesAdded",7);this.balFilesRemoved=n(this,"balFilesRemoved",7);this.balRejectedFile=n(this,"balRejectedFile",7);this.balInputClick=n(this,"balInputClick",7);this.balBlur=n(this,"balBlur",7);this.balFocus=n(this,"balFocus",7);this.fileUploadId="bal-file-upload-".concat(L++);this.initialValue=this.value||[];this.addEventListenerDragAndDrop=function(){if(i.labelEl){i.labelEl.addEventListener("dragenter",i.onDragenter,false);i.labelEl.addEventListener("dragover",i.onDragover,false);i.labelEl.addEventListener("drop",i.onDrop,false)}};this.removeEventListenerDragAndDrop=function(){if(i.labelEl){i.labelEl.removeEventListener("dragenter",i.onDragenter,false);i.labelEl.removeEventListener("dragover",i.onDragover,false);i.labelEl.removeEventListener("drop",i.onDrop,false)}};this.handleFiles=function(e){var t=x(e);var n=w(i.files,t,{accept:i.accept,maxFileSize:i.maxFileSize,maxBundleSize:i.maxBundleSize,maxFiles:i.maxFiles});if(n.invalidFiles.length>0){i.balRejectedFile.emit(n.invalidFiles[0])}if(n.validFiles.length>0){i.balFilesAdded.emit(n.validFiles);i.files=__spreadArray(__spreadArray([],i.files,true),n.validFiles,true);i.balChange.emit(i.files)}i.updateFileInput()};this.updateFileInput=function(){var e;if((e=i.nativeInput)===null||e===void 0?void 0:e.files){i.nativeInput.files=C(i.files)}};this.onDragenter=function(e){s(e)};this.onDragover=function(e){s(e)};this.onDrop=function(e){s(e);if(!i.disabled&&!i.readonly&&!i.loading){var t=e.dataTransfer;if(t){i.handleFiles(t.files)}}};this.onInputChange=function(){var e;if(!i.disabled&&!i.readonly&&!i.loading){if((e=i.nativeInput)===null||e===void 0?void 0:e.files){i.handleFiles(i.nativeInput.files)}}};this.onRemoveFile=function(e,t){s(e);if(t>=0&&t<i.files.length){var n=i.files;var a=n.splice(t,1);i.balFilesRemoved.emit(a);i.files=__spreadArray([],n,true);i.balChange.emit(i.files);i.updateFileInput()}};this.onHostClick=function(e){return o(i,e)};this.onInputFocus=function(e){return u(i,e)};this.onInputBlur=function(e){return d(i,e)};this.onInputClick=function(e){if(i.nativeInput&&!i.disabled&&!i.readonly&&!i.loading){i.nativeInput.value=""}i.balInputClick.emit(e)};this.files=[];this.focused=false;this.ariaForm=g;this.name=this.fileUploadId;this.value=[];this.label="Choose or drop a file...";this.multiple=true;this.disabled=false;this.readonly=false;this.loading=false;this.required=false;this.accept=undefined;this.maxFiles=undefined;this.maxFileSize=undefined;this.maxBundleSize=undefined;this.hasFileList=true;this.invalid=false;this.subTitle=undefined}e.prototype.createLogger=function(e){this.log=e};e.prototype.onValueChange=function(){if(!r(this.files,this.value)){this.files=this.value}};e.prototype.componentWillLoad=function(){this.onValueChange()};e.prototype.connectedCallback=function(){this.initialValue=this.value||[];this.addEventListenerDragAndDrop()};e.prototype.componentDidLoad=function(){this.addEventListenerDragAndDrop()};e.prototype.disconnectedCallback=function(){this.removeEventListenerDragAndDrop()};e.prototype.resetHandler=function(e){var i=this;var t=e.target;if(t===null||t===void 0?void 0:t.contains(this.el)){this.files=__spreadArray([],this.initialValue,true);clearTimeout(this.resetHandlerTimer);this.resetHandlerTimer=setTimeout((function(){if(i.nativeInput){i.nativeInput.files=C(i.initialValue)}}))}};e.prototype.clear=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.files=[];this.updateFileInput();return[2]}))}))};e.prototype.setFocus=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){f(this);return[2]}))}))};e.prototype.setBlur=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){c(this);return[2]}))}))};e.prototype.getInputElement=function(){return Promise.resolve(this.nativeInput)};e.prototype.setAriaForm=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){this.ariaForm=Object.assign({},e);return[2]}))}))};e.prototype.render=function(){var e=this;var t=this.ariaForm.controlId||this.fileUploadId;return i(a,{onClick:this.onHostClick,"aria-disabled":this.disabled?"true":null,class:{"bal-file-upload":true}},i("div",{class:{file:true,"is-disabled":this.disabled||this.readonly||this.loading,"is-danger":this.invalid}},i("label",{htmlFor:t,ref:function(i){return e.labelEl=i},class:{"file-label":true,"is-disabled":this.disabled||this.loading||this.readonly}},i("input",{class:"file-input",type:"file",id:t,"aria-labelledby":this.ariaForm.labelId,"aria-describedby":this.ariaForm.messageId,"aria-invalid":this.invalid===true?"true":"false","aria-disabled":this.disabled?"true":null,name:this.name,multiple:this.multiple,disabled:this.disabled||this.loading||this.readonly,readonly:this.readonly,required:this.required,accept:this.accept,onClick:this.onInputClick,onChange:this.onInputChange,onFocus:this.onInputFocus,onBlur:this.onInputBlur,ref:function(i){return e.nativeInput=i},"data-testid":"bal-file-upload-input"}),this.loading?i("span",{class:"file-cta"},i("bal-spinner",null)):i("span",{class:"file-cta"},i("span",{class:"file-icon"},i("bal-icon",{name:"upload",size:"medium",color:this.disabled||this.loading||this.readonly?"grey-light":this.invalid?"danger":"blue"})),i("span",{class:"file-label","data-testid":"bal-file-upload-label"},this.label)))),this.hasFileList&&this.files.length>0?i(E,{files:this.files,disabled:this.disabled||this.readonly||this.loading,subTitle:this.subTitle,onRemoveFile:this.onRemoveFile}):"")};Object.defineProperty(e.prototype,"el",{get:function(){return l(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{value:["onValueChange"]}},enumerable:false,configurable:true});return e}());D([h("bal-file-upload")],k.prototype,"createLogger",null);var L=0;k.style={css:j}}}}));